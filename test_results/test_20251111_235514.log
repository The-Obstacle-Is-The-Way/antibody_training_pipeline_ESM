2025-11-11 23:55:14,859 - antibody_training_esm.cli.test - INFO - Starting model testing
2025-11-11 23:55:14,859 - antibody_training_esm.cli.test - INFO - Models to test: ['models/boughter_vh_esm2_650m_logreg.pkl']
2025-11-11 23:55:14,859 - antibody_training_esm.cli.test - INFO - Datasets to test: ['test_datasets/shehata/fragments/VH_only_shehata.csv']
2025-11-11 23:55:14,859 - antibody_training_esm.cli.test - INFO - 
============================================================
2025-11-11 23:55:14,859 - antibody_training_esm.cli.test - INFO - Testing on dataset: VH_only_shehata
2025-11-11 23:55:14,860 - antibody_training_esm.cli.test - INFO - ============================================================
2025-11-11 23:55:14,860 - antibody_training_esm.cli.test - INFO - Loading dataset from test_datasets/shehata/fragments/VH_only_shehata.csv
2025-11-11 23:55:14,862 - antibody_training_esm.cli.test - INFO - Loaded 398 samples from test_datasets/shehata/fragments/VH_only_shehata.csv (sequence_col='sequence', label_col='label')
2025-11-11 23:55:14,862 - antibody_training_esm.cli.test - INFO -   Label distribution: {0: 391, 1: 7}
2025-11-11 23:55:14,862 - antibody_training_esm.cli.test - INFO - 
Testing model: boughter_vh_esm2_650m_logreg
2025-11-11 23:55:14,863 - antibody_training_esm.cli.test - INFO - Loading model from models/boughter_vh_esm2_650m_logreg.pkl
2025-11-11 23:55:16,156 - antibody_training_esm.core.embeddings - INFO - ESM model facebook/esm2_t33_650M_UR50D (revision=main) loaded on mps with batch_size=8 and max_length=1024
2025-11-11 23:55:16,156 - antibody_training_esm.cli.test - INFO - Updating batch_size from 8 to 32
2025-11-11 23:55:16,156 - antibody_training_esm.cli.test - INFO - Model loaded successfully: models/boughter_vh_esm2_650m_logreg.pkl on device: mps
2025-11-11 23:55:16,157 - antibody_training_esm.cli.test - INFO - Extracting embeddings for 398 sequences...
2025-11-11 23:55:16,157 - antibody_training_esm.core.embeddings - INFO - Extracting embeddings for 398 sequences with batch_size=32...
2025-11-11 23:55:31,272 - antibody_training_esm.cli.test - INFO - Embeddings cached to ./test_results/VH_only_shehata_boughter_vh_esm2_650m_logreg_test_embeddings.pkl
2025-11-11 23:55:31,272 - antibody_training_esm.cli.test - INFO - Evaluating pretrained model boughter_vh_esm2_650m_logreg on VH_only_shehata
2025-11-11 23:55:31,281 - antibody_training_esm.cli.test - INFO - Test results for boughter_vh_esm2_650m_logreg on VH_only_shehata:
2025-11-11 23:55:31,281 - antibody_training_esm.cli.test - INFO -   accuracy: 0.4196
2025-11-11 23:55:31,281 - antibody_training_esm.cli.test - INFO -   precision: 0.0172
2025-11-11 23:55:31,281 - antibody_training_esm.cli.test - INFO -   recall: 0.5714
2025-11-11 23:55:31,281 - antibody_training_esm.cli.test - INFO -   f1: 0.0335
2025-11-11 23:55:31,281 - antibody_training_esm.cli.test - INFO -   roc_auc: 0.5601
2025-11-11 23:55:31,281 - antibody_training_esm.cli.test - INFO -   pr_auc: 0.0376
2025-11-11 23:55:31,281 - antibody_training_esm.cli.test - INFO - Using hierarchical output: ./test_results/esm2_650m/logreg/VH_only_shehata (backbone=esm2_650m, classifier=logreg)
2025-11-11 23:55:31,282 - antibody_training_esm.cli.test - INFO - Creating confusion matrices for VH_only_shehata in ./test_results/esm2_650m/logreg/VH_only_shehata
2025-11-11 23:55:31,510 - antibody_training_esm.cli.test - INFO - Confusion matrix saved to ./test_results/esm2_650m/logreg/VH_only_shehata/confusion_matrix_boughter_vh_esm2_650m_logreg_VH_only_shehata.png
2025-11-11 23:55:31,517 - antibody_training_esm.cli.test - INFO - Detailed results saved to ./test_results/esm2_650m/logreg/VH_only_shehata/detailed_results_boughter_vh_esm2_650m_logreg_VH_only_shehata_20251111_235531.yaml
2025-11-11 23:55:31,518 - antibody_training_esm.cli.test - INFO - Predictions saved to ./test_results/esm2_650m/logreg/VH_only_shehata/predictions_boughter_vh_esm2_650m_logreg_VH_only_shehata_20251111_235531.csv
2025-11-11 23:55:31,518 - antibody_training_esm.cli.test - INFO - 
Testing completed. Results saved to: ./test_results
2025-11-11 23:55:31,518 - antibody_training_esm.cli.test - INFO - Cleaning up cached embedding files...
2025-11-11 23:55:31,519 - antibody_training_esm.cli.test - INFO - Deleted cached embeddings: ./test_results/VH_only_shehata_boughter_vh_esm2_650m_logreg_test_embeddings.pkl
