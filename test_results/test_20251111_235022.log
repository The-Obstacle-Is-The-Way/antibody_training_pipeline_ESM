2025-11-11 23:50:22,773 - antibody_training_esm.cli.test - INFO - Starting model testing
2025-11-11 23:50:22,773 - antibody_training_esm.cli.test - INFO - Models to test: ['models/boughter_vh_esm2_650m_logreg.pkl']
2025-11-11 23:50:22,773 - antibody_training_esm.cli.test - INFO - Datasets to test: ['test_datasets/jain/canonical/VH_only_jain_test_PARITY_86.csv']
2025-11-11 23:50:22,773 - antibody_training_esm.cli.test - INFO - 
============================================================
2025-11-11 23:50:22,773 - antibody_training_esm.cli.test - INFO - Testing on dataset: VH_only_jain_test_PARITY_86
2025-11-11 23:50:22,773 - antibody_training_esm.cli.test - INFO - ============================================================
2025-11-11 23:50:22,773 - antibody_training_esm.cli.test - INFO - Loading dataset from test_datasets/jain/canonical/VH_only_jain_test_PARITY_86.csv
2025-11-11 23:50:22,775 - antibody_training_esm.cli.test - INFO - Loaded 86 samples from test_datasets/jain/canonical/VH_only_jain_test_PARITY_86.csv (sequence_col='sequence', label_col='label')
2025-11-11 23:50:22,775 - antibody_training_esm.cli.test - INFO -   Label distribution: {0.0: 59, 1.0: 27}
2025-11-11 23:50:22,775 - antibody_training_esm.cli.test - INFO - 
Testing model: boughter_vh_esm2_650m_logreg
2025-11-11 23:50:22,775 - antibody_training_esm.cli.test - INFO - Loading model from models/boughter_vh_esm2_650m_logreg.pkl
2025-11-11 23:50:23,973 - antibody_training_esm.core.embeddings - INFO - ESM model facebook/esm2_t33_650M_UR50D (revision=main) loaded on mps with batch_size=8 and max_length=1024
2025-11-11 23:50:23,973 - antibody_training_esm.cli.test - INFO - Updating batch_size from 8 to 32
2025-11-11 23:50:23,973 - antibody_training_esm.cli.test - INFO - Model loaded successfully: models/boughter_vh_esm2_650m_logreg.pkl on device: mps
2025-11-11 23:50:23,973 - antibody_training_esm.cli.test - INFO - Extracting embeddings for 86 sequences...
2025-11-11 23:50:23,973 - antibody_training_esm.core.embeddings - INFO - Extracting embeddings for 86 sequences with batch_size=32...
2025-11-11 23:50:27,184 - antibody_training_esm.cli.test - INFO - Embeddings cached to ./test_results/VH_only_jain_test_PARITY_86_boughter_vh_esm2_650m_logreg_test_embeddings.pkl
2025-11-11 23:50:27,184 - antibody_training_esm.cli.test - INFO - Evaluating pretrained model boughter_vh_esm2_650m_logreg on VH_only_jain_test_PARITY_86
2025-11-11 23:50:27,197 - antibody_training_esm.cli.test - INFO - Test results for boughter_vh_esm2_650m_logreg on VH_only_jain_test_PARITY_86:
2025-11-11 23:50:27,197 - antibody_training_esm.cli.test - INFO -   accuracy: 0.6279
2025-11-11 23:50:27,197 - antibody_training_esm.cli.test - INFO -   precision: 0.4286
2025-11-11 23:50:27,197 - antibody_training_esm.cli.test - INFO -   recall: 0.5556
2025-11-11 23:50:27,197 - antibody_training_esm.cli.test - INFO -   f1: 0.4839
2025-11-11 23:50:27,197 - antibody_training_esm.cli.test - INFO -   roc_auc: 0.6127
2025-11-11 23:50:27,197 - antibody_training_esm.cli.test - INFO -   pr_auc: 0.4663
2025-11-11 23:50:27,197 - antibody_training_esm.cli.test - INFO - Using hierarchical output: ./test_results/esm2_650m/logreg/VH_only_jain_test_PARITY_86 (backbone=esm2_650m, classifier=logreg)
2025-11-11 23:50:27,198 - antibody_training_esm.cli.test - INFO - Creating confusion matrices for VH_only_jain_test_PARITY_86 in ./test_results/esm2_650m/logreg/VH_only_jain_test_PARITY_86
2025-11-11 23:50:27,435 - antibody_training_esm.cli.test - INFO - Confusion matrix saved to ./test_results/esm2_650m/logreg/VH_only_jain_test_PARITY_86/confusion_matrix_boughter_vh_esm2_650m_logreg_VH_only_jain_test_PARITY_86.png
2025-11-11 23:50:27,438 - antibody_training_esm.cli.test - INFO - Detailed results saved to ./test_results/esm2_650m/logreg/VH_only_jain_test_PARITY_86/detailed_results_boughter_vh_esm2_650m_logreg_VH_only_jain_test_PARITY_86_20251111_235027.yaml
2025-11-11 23:50:27,440 - antibody_training_esm.cli.test - INFO - Predictions saved to ./test_results/esm2_650m/logreg/VH_only_jain_test_PARITY_86/predictions_boughter_vh_esm2_650m_logreg_VH_only_jain_test_PARITY_86_20251111_235027.csv
2025-11-11 23:50:27,440 - antibody_training_esm.cli.test - INFO - 
Testing completed. Results saved to: ./test_results
2025-11-11 23:50:27,440 - antibody_training_esm.cli.test - INFO - Cleaning up cached embedding files...
2025-11-11 23:50:27,440 - antibody_training_esm.cli.test - INFO - Deleted cached embeddings: ./test_results/VH_only_jain_test_PARITY_86_boughter_vh_esm2_650m_logreg_test_embeddings.pkl
