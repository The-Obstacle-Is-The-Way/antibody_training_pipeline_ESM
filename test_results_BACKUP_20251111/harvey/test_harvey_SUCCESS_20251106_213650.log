2025-11-06 21:36:50,458 - __main__ - INFO - Starting model testing
2025-11-06 21:36:50,459 - __main__ - INFO - Models to test: ['models/boughter_vh_esm1v_logreg.pkl']
2025-11-06 21:36:50,459 - __main__ - INFO - Datasets to test: ['test_datasets/harvey/fragments/VHH_only_harvey.csv']
2025-11-06 21:36:50,459 - __main__ - INFO - 
============================================================
2025-11-06 21:36:50,459 - __main__ - INFO - Testing on dataset: VHH_only_harvey
2025-11-06 21:36:50,459 - __main__ - INFO - ============================================================
2025-11-06 21:36:50,459 - __main__ - INFO - Loading dataset from test_datasets/harvey/fragments/VHH_only_harvey.csv
2025-11-06 21:36:50,658 - __main__ - INFO - Loaded 141021 samples from test_datasets/harvey/fragments/VHH_only_harvey.csv (sequence_col='sequence', label_col='label')
2025-11-06 21:36:50,678 - __main__ - INFO -   Label distribution: {1: 71759, 0: 69262}
2025-11-06 21:36:50,684 - __main__ - INFO - 
Testing model: boughter_vh_esm1v_logreg
2025-11-06 21:36:50,684 - __main__ - INFO - Loading model from models/boughter_vh_esm1v_logreg.pkl
2025-11-06 21:36:52,107 - antibody_training_esm.core.embeddings - INFO - ESM model facebook/esm1v_t33_650M_UR90S_1 loaded on mps with batch_size=8
2025-11-06 21:36:52,107 - __main__ - INFO - Updating batch_size from 8 to 32
2025-11-06 21:36:52,107 - __main__ - INFO - Model loaded successfully: models/boughter_vh_esm1v_logreg.pkl on device: mps
2025-11-06 21:36:52,107 - __main__ - INFO - Extracting embeddings for 141021 sequences...
2025-11-06 21:36:52,107 - antibody_training_esm.core.embeddings - INFO - Extracting embeddings for 141021 sequences with batch_size=32...
2025-11-06 22:39:04,610 - __main__ - INFO - Embeddings cached to test_results/VHH_only_harvey_boughter_vh_esm1v_logreg_test_embeddings.pkl
2025-11-06 22:39:04,611 - __main__ - INFO - Evaluating pretrained model boughter_vh_esm1v_logreg on VHH_only_harvey
2025-11-06 22:39:05,238 - __main__ - INFO - Test results for boughter_vh_esm1v_logreg on VHH_only_harvey:
2025-11-06 22:39:05,238 - __main__ - INFO -   accuracy: 0.5909
2025-11-06 22:39:05,238 - __main__ - INFO -   precision: 0.5562
2025-11-06 22:39:05,238 - __main__ - INFO -   recall: 0.9702
2025-11-06 22:39:05,238 - __main__ - INFO -   f1: 0.7071
2025-11-06 22:39:05,238 - __main__ - INFO -   roc_auc: 0.7538
2025-11-06 22:39:05,238 - __main__ - INFO -   pr_auc: 0.7258
2025-11-06 22:39:05,238 - __main__ - INFO - Creating confusion matrix for VHH_only_harvey
2025-11-06 22:39:05,460 - __main__ - INFO - Confusion matrix saved to test_results/confusion_matrix_VHH_only_harvey.png
2025-11-06 22:39:07,079 - __main__ - INFO - Detailed results saved to test_results/detailed_results_VHH_only_harvey_20251106_223905.yaml
2025-11-06 22:39:07,079 - __main__ - INFO - 
Testing completed. Results saved to: test_results
2025-11-06 22:39:07,079 - __main__ - INFO - Cleaning up cached embedding files...
2025-11-06 22:39:07,129 - __main__ - INFO - Deleted cached embeddings: test_results/VHH_only_harvey_boughter_vh_esm1v_logreg_test_embeddings.pkl
