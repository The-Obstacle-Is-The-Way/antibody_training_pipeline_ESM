# Boughter Training Data - Canonical Files

This directory contains the **authoritative training file** for the Boughter 2020 dataset.

---

## Primary Training File

**`VH_only_boughter_training.csv`** - 914 sequences

This is the file used to train the ESM-1v + Logistic Regression classifier.

### Label Definition (Novo Nordisk Flagging)

The `label` column is derived from the Novo Nordisk flagging strategy:

- **label=0 (Specific):** 0 polyreactivity flags (461 sequences → 443 after QC)
- **label=1 (Non-specific):** 4+ polyreactivity flags (487 sequences → 471 after QC)

**Excluded:** Sequences with 1-3 flags (mild polyreactivity) are excluded from training.

### Columns

**ACTUAL COLUMNS IN FILE:**
- `sequence` - VH domain amino acid sequence (ANARCI-annotated)
- `label` - Binary classification label (0.0=specific, 1.0=non-specific)

**NOTE:** The training CSV is intentionally minimal (sequence + label only) for model training. The full annotated data with metadata (id, subset, num_flags, etc.) is in `data/train/boughter/annotated/VH_only_boughter.csv`.

### Statistics

```
Total sequences:       914
  Specific (label=0):   443 (48.5%)
  Non-specific (1):     471 (51.5%)

Label Balance:         1.06:1 (well-balanced)
```

---

## Provenance

**Generated by:** `preprocessing/boughter/stage2_stage3_annotation_qc.py`
**Source:** `data/train/boughter/processed/boughter.csv` (1,117 sequences)
**Processing:**
1. ANARCI annotation (IMGT numbering) → 1,110 sequences
2. QC filtering (no X in CDRs, no empty CDRs) → 1,065 sequences
3. Novo flagging filter (exclude 1-3 flags) → 914 sequences

**Documentation:** See `data/train/BOUGHTER_DATA_PROVENANCE.md` for complete lineage

---

## Usage

```python
import pandas as pd

# Load training data
df = pd.read_csv('data/train/boughter/canonical/VH_only_boughter_training.csv', comment='#')

# NOTE: Columns are 'sequence' and 'label' (not 'vh_sequence')
sequences = df['sequence'].tolist()  # NOT 'vh_sequence'!
labels = df['label'].values

print(f"Loaded {len(sequences)} training sequences")
print(f"Label distribution: {pd.Series(labels).value_counts().to_dict()}")
```

---

**Last Updated:** 2025-11-05
